# Coding Brain Infrastructure Environment Variables
# Copy this file to .env and fill in the values
#
# IMPORTANT: Never commit .env files with real secrets to version control!
#
# See docs/SECRET-ROTATION.md for rotation schedules and procedures.

# ============================================================================
# Required Secrets (Application will fail to start if missing)
# ============================================================================

# JWT signing key - minimum 32 characters
# Generate with: openssl rand -base64 48
# Rotation: Every 90 days
JWT_SECRET_KEY=CHANGE_ME_jwt_secret_at_least_32_chars_long

# PostgreSQL password
# Rotation: Every 180 days
POSTGRES_PASSWORD=CHANGE_ME_postgres_password

# Neo4j password
# Rotation: Every 180 days
NEO4J_PASSWORD=CHANGE_ME_neo4j_password

# OpenAI API key for embeddings and LLM calls
# Rotation: Every 30-90 days
OPENAI_API_KEY=sk-CHANGE_ME
OLLAMA_BASE_URL=http://localhost:11434

# ============================================================================
# PostgreSQL Configuration
# ============================================================================
POSTGRES_USER=codingbrain
POSTGRES_DB=codingbrain
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# ============================================================================
# Neo4j Configuration
# ============================================================================
NEO4J_USERNAME=neo4j
NEO4J_URL=bolt://neo4j:7687
NEO4J_DATABASE=neo4j

# ============================================================================
# OpenSearch Configuration
# ============================================================================
# Must meet complexity requirements: uppercase, lowercase, number, special char
OPENSEARCH_INITIAL_ADMIN_PASSWORD=CHANGE_ME_Opensearch1!
OPENSEARCH_HOSTS=opensearch:9200
OPENSEARCH_USE_SSL=false
OPENSEARCH_VERIFY_CERTS=true
OPENSEARCH_TIMEOUT=30
OPENSEARCH_MAX_RETRIES=3
OPENSEARCH_POOL_CONNECTIONS=10
OPENSEARCH_POOL_MAXSIZE=10

# ============================================================================
# Valkey (Redis-compatible) Configuration
# ============================================================================
VALKEY_HOST=valkey
VALKEY_PORT=6379
# Alternative URL format (legacy)
VALKEY_URL=redis://valkey:6379

# ============================================================================
# Qdrant Vector Database Configuration
# ============================================================================
QDRANT_HOST=qdrant
QDRANT_PORT=6333

# ============================================================================
# JWT / OAuth 2.0 Configuration
# ============================================================================
# JWT signing algorithm (HS256, RS256, ES256, EdDSA)
JWT_ALGORITHM=HS256

# Token issuer (your auth server URL)
JWT_ISSUER=https://codingbrain.local

# Token audience (your API URL)
JWT_AUDIENCE=https://api.codingbrain.local

# Token expiry in minutes
JWT_EXPIRY_MINUTES=60

# ============================================================================
# User Configuration
# ============================================================================
USER=default_user

# Internal API key for service authentication (optional)
API_KEY=CHANGE_ME_api_key

# ============================================================================
# CORS Configuration
# ============================================================================
# Comma-separated list of allowed origins (use * for development only)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3433,http://localhost:8865

# ============================================================================
# UI Configuration
# ============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8865

# ============================================================================
# Business Concepts Feature (Optional)
# ============================================================================
BUSINESS_CONCEPTS_ENABLED=false
BUSINESS_CONCEPTS_AUTO_EXTRACT=false
BUSINESS_CONCEPTS_EMBEDDING_ENABLED=true
BUSINESS_CONCEPTS_EXTRACTION_MODEL=qwen3:8b
BUSINESS_CONCEPTS_MIN_CONFIDENCE=0.5
